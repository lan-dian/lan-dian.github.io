<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>docker-入门 | 岚殿的技术博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="Java后端技术博客">
    <meta name="keywords" content="Java,后端,技术,博客">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.bf945c37.css" as="style"><link rel="preload" href="/assets/js/app.08014c82.js" as="script"><link rel="preload" href="/assets/js/2.74fbac12.js" as="script"><link rel="preload" href="/assets/js/10.04dc144d.js" as="script"><link rel="prefetch" href="/assets/js/11.358ffd36.js"><link rel="prefetch" href="/assets/js/12.bef0908d.js"><link rel="prefetch" href="/assets/js/13.f68e14fb.js"><link rel="prefetch" href="/assets/js/14.fdcc33a0.js"><link rel="prefetch" href="/assets/js/15.3193a1b8.js"><link rel="prefetch" href="/assets/js/16.2a663ced.js"><link rel="prefetch" href="/assets/js/17.c5fb2d31.js"><link rel="prefetch" href="/assets/js/18.8c4103a5.js"><link rel="prefetch" href="/assets/js/3.a6e6f7b6.js"><link rel="prefetch" href="/assets/js/4.4a01c80f.js"><link rel="prefetch" href="/assets/js/5.46dd246f.js"><link rel="prefetch" href="/assets/js/6.0096bbf7.js"><link rel="prefetch" href="/assets/js/7.0d424c93.js"><link rel="prefetch" href="/assets/js/8.aac5a500.js"><link rel="prefetch" href="/assets/js/9.7e234665.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bf945c37.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="岚殿的技术博客" class="logo"> <span class="site-name can-hide">岚殿的技术博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/java/" class="nav-link">Java</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术学习" class="dropdown-title"><a href="/web/" class="link-title">技术学习</a> <span class="title" style="display:none;">技术学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/479a6c/" aria-current="page" class="nav-link router-link-exact-active router-link-active">docker</a></li><li class="dropdown-item"><!----> <a href="/pages/0d9ac7/" class="nav-link">hbase</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="AI大模型" class="dropdown-title"><a href="/ai/" class="link-title">AI大模型</a> <span class="title" style="display:none;">AI大模型</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/0c8b87/" class="nav-link">提示词工程</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/lan-dian" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.png"> <div class="blogger-info"><h3>岚殿</h3> <span></span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/java/" class="nav-link">Java</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术学习" class="dropdown-title"><a href="/web/" class="link-title">技术学习</a> <span class="title" style="display:none;">技术学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/479a6c/" aria-current="page" class="nav-link router-link-exact-active router-link-active">docker</a></li><li class="dropdown-item"><!----> <a href="/pages/0d9ac7/" class="nav-link">hbase</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="AI大模型" class="dropdown-title"><a href="/ai/" class="link-title">AI大模型</a> <span class="title" style="display:none;">AI大模型</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/0c8b87/" class="nav-link">提示词工程</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/lan-dian" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>docker</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/479a6c/" aria-current="page" class="active sidebar-link">docker-入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/479a6c/#是什么" class="sidebar-link">是什么</a></li><li class="sidebar-sub-header level2"><a href="/pages/479a6c/#怎么用" class="sidebar-link">怎么用</a></li><li class="sidebar-sub-header level2"><a href="/pages/479a6c/#概念" class="sidebar-link">概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#镜像-image" class="sidebar-link">镜像(image)</a></li><li class="sidebar-sub-header level4"><a href="/pages/479a6c/#分层存储" class="sidebar-link">分层存储</a></li><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#容器" class="sidebar-link">容器</a></li><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#registry" class="sidebar-link">Registry</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/479a6c/#使用" class="sidebar-link">使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#基本命令" class="sidebar-link">基本命令</a></li><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#数据卷-volume" class="sidebar-link">数据卷(volume)</a></li><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#网络" class="sidebar-link">网络</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/479a6c/#dockerfile" class="sidebar-link">DockerFile</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#from" class="sidebar-link">FROM</a></li><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#run" class="sidebar-link">RUN</a></li><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#copy" class="sidebar-link">COPY</a></li><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#cmd" class="sidebar-link">CMD</a></li><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#env" class="sidebar-link">ENV</a></li><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#avg" class="sidebar-link">AVG</a></li><li class="sidebar-sub-header level3"><a href="/pages/479a6c/#例子" class="sidebar-link">例子</a></li></ul></li></ul></li><li><a href="/pages/4d9eaa/" class="sidebar-link">docker-原理</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>hbase</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/web/#技术学习" data-v-06225672>技术学习</a></li><li data-v-06225672><a href="/web/#docker" data-v-06225672>docker</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/lan-dian" target="_blank" title="作者" class="beLink" data-v-06225672>lan-dian</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-04-08</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">docker-入门<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="是什么"><a href="#是什么" class="header-anchor">#</a> 是什么</h2> <p>Docker是一个容器技术，对进程进行封装隔离，进一步提供了文件系统，网络的隔离，屏蔽底层运行环境的差异，做到了完全一致。而且，比虚拟机的性能高出数倍。</p> <blockquote><p>和传统虚拟技术的差异</p></blockquote> <p>传统的虚拟技术会虚拟硬件，虚拟操作系统，然后在该系统上运行进程。而Docker直接使用Linux提供的各种隔离技术，直接运行于主机上。</p> <blockquote><p>架构</p></blockquote> <p>Docker 在运行时分为 Docker 引擎（也就是服务端守护进程）和客户端工具。
也就是说，看起来是本地执行命令，其实原创也是支持的。</p> <h2 id="怎么用"><a href="#怎么用" class="header-anchor">#</a> 怎么用</h2> <blockquote><p>一致的运行环境</p></blockquote> <p>由于开发环境、测试环境、生产环境不一致，导致有些 bug 并未在开发过程中被发现。而 Docker 的镜像提供了<strong>除内核外</strong>完整的运行时环境，确保了应用运行环境一致性。
环境一致对开发也非常重要，如果是因为环境因素导致的问题，那么本地和上线的代码就不一样，而且解决起问题也会十分的麻烦。</p> <blockquote><p>一次编写，到处运行</p></blockquote> <p>使用DockerFile，可以做到一次配置，可以快速的任何环境下完成部署，我们也常常感受到自己配置环境是非常麻烦的，而且在不同的机器上，由于之前环境的干扰，会出现很多意想不到的问题。</p> <blockquote><p>部署服务</p></blockquote> <p>刚接触Linux，我们部署MySql，可能是下载安装配置等等，每个应用的流程都不一样，非常繁琐。
之后我们知道了apt这样的管理工具可以让我们的部署大幅度简化。
但是，如果之后需要部署什么东西，我们可以优先在网络上查询docker安装xxx，以此来提高速度，节约我们在环境上的时间。</p> <h2 id="概念"><a href="#概念" class="header-anchor">#</a> 概念</h2> <p>任何技术的学习都要明确他的概念，他基于了设计者的设计理念，方便我们和其他人交流复杂的概念。</p> <h3 id="镜像-image"><a href="#镜像-image" class="header-anchor">#</a> 镜像(image)</h3> <p>可以理解为一个独立系统打包后的所有内容，不包含任何的动态数据，本质是一个文件。</p> <h4 id="分层存储"><a href="#分层存储" class="header-anchor">#</a> 分层存储</h4> <p>镜像构建时，会一层层构建，前一层是后一层的基础。每一层构建完就不会再发生改变，后一层上的任何改变只发生在自己这一层。
甚至在删除一层文件的时候，都仅仅只是标记删除，会对镜像的体积照成影响，额外的东西要在本层构建结束之前删掉。
这样的分层设计，支持镜像的复用，我们也可以在已经有的镜像之上构建新的镜像。</p> <h3 id="容器"><a href="#容器" class="header-anchor">#</a> 容器</h3> <p>如果说镜像是文件，那么容器就是运行时。容器可以被创建、启动、停止、删除、暂停等。本质是一个进程。
但是这个进程有自己独立的命名空间，所以有自己的文件系统，网络等等隔离特性。
容器运行的本质就是，以镜像为基础层，在其上创建一个当前容器的存储层，我们可以称这个为容器<strong>运行时读写</strong>而准备的存储层为<strong>容器存储层</strong>。容器存储层的生存周期和容器一样，容器消亡时，容器存储层也随之消亡。因此，任何保存于容器存储层的信息都会随容器删除而丢失。所以要求我们必须在数据卷读写，其实本质就是文件读写的重定向。</p> <h3 id="registry"><a href="#registry" class="header-anchor">#</a> Registry</h3> <p>镜像是本地文件，docker的本质就为了让不同的环境运行，势必要方便拿到镜像。仓库是类型github的网址，里面有多个tag，一般代表不同的版本。默认tag是最新的版本。</p> <h2 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h2> <h3 id="基本命令"><a href="#基本命令" class="header-anchor">#</a> 基本命令</h3> <blockquote><p>docker pull</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker pull ubuntu
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>从Registry拉取镜像。
下载的时候，本质是在下载一个文件组，通过分层下载的方式，之前下载的过的文件会直接复用。
同理，push可以把本地构建的镜像推送到云端。</p> <blockquote><p>docker run</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run -itd ubuntu bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>运行镜像-&gt;容器。
可以加-it参数，一个是 -i：交互式操作，一个是 -t 终端。
-d：后台执行。
通过exit退出。
进入正在运行容器是exec，其他的完全一样</p> <blockquote><p>容器命令</p></blockquote> <p>docker ps -a
查看容器
docker start xxx
docker stop xxx
docker restart xxx
docker rm xxx</p> <blockquote><p>docker logs -f</p></blockquote> <p>可以和tail -f一样，查看日志。</p> <blockquote><p>docker image ls</p></blockquote> <p>列出已经下载的镜像，后面可以加关键词搜索我们想看的
这里有一个关键概念，ID，在我们需要操作镜像的时候，需要输入ID前3位，知道可以区分出他们就可以。
可以使用docker image prune来清理镜像空间</p> <blockquote><p>docker image rm</p></blockquote> <p>remove删除镜像
值得注意的是，docke保护我们不会删除有运行容器的镜像，所以必须先删除容器，再删除镜像。</p> <h3 id="数据卷-volume"><a href="#数据卷-volume" class="header-anchor">#</a> 数据卷(volume)</h3> <p>数据卷就是挂载在我们磁盘空间的，不受容器影响的文件系统。我的理解是，可以让容器操作我们的目录，这个和容器无关的目录，数据卷提供了这种映射关系。
可以通过-v 源目录:容器目录
我们可以发现，docker都是源目录在前，容器目录在后的，此外，源目录必须是绝对路径。</p> <h3 id="网络"><a href="#网络" class="header-anchor">#</a> 网络</h3> <p>docker数据比较简单，但是网络确实是有难度的，之前我们说了网络会被隔离，那么我们如何访问docker内的服务呢。
docker提供了端口映射的功能，使用-p来指定，如果我们访问了本地的某个端口，就可以访问到容器内的某个端口。
可是docker容器内的网络如何访问呢，这里docker给我们提供了一个机制，可以把容器加入一个互通的网络里面，docker network create -d bridge my-net，可以都使用这一个网络。
运行的时候，使用 --network my-net 就可以接入这个网络了。
但是如果你有多个容器之间需要互相连接，推荐使用 Docker Compose。</p> <h2 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> DockerFile</h2> <p>docker build -t xxxx:xxx .</p> <blockquote><p>docker build工作原理</p></blockquote> <p>我们执行的命令本质是一个客户端，真正的打包是在docker服务端完成的，当我们进行镜像构建的时候，并非所有定制都会通过 RUN 指令完成，经常会需要将一些本地文件复制进镜像，比如通过 COPY 指令、ADD 指令等。如何才能让服务端获得本地文件呢？
这就是上下文的概念，会把这个路径下的所有文件打包，放进上传给docker服务端。
所以：COPY 这类指令中的源文件的路径都是相对路径。为什么 COPY ../package.json /app 或者 COPY /opt/xxxx /app 无法工作的原因，因为这些路径已经超出了上下文的范围，Docker 引擎无法获得这些位置的文件。如果真的需要那些文件，应该将它们复制到上下文目录中去。
同理，可以用 .gitignore 一样的语法写一个 .dockerignore，该文件是用于剔除不需要作为上下文传递给 Docker 引擎的。</p> <h3 id="from"><a href="#from" class="header-anchor">#</a> FROM</h3> <p>基于哪个镜像开始构建，操作系统都是轻量级的，比如apt，我们必须先执行apt update，然后才能进行安装，不然会报错</p> <h3 id="run"><a href="#run" class="header-anchor">#</a> RUN</h3> <p>运行命令，这里有个小细节，因为每次RUN都会构建新的层，所以我们可以使用Linux的换行命令实现</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>RUN set -x; buildDeps='mysql' \
  &amp;&amp; apt update \
  &amp;&amp; apt install -y $buildDeps \
  &amp;&amp; apt purge -y --auto-remove $buildDeps
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="copy"><a href="#copy" class="header-anchor">#</a> COPY</h3> <p>COPY 源路径 目标路径</p> <blockquote><p>源路径</p></blockquote> <p>基于build时指定的路径，相当于把哪些文件复制到一个地方的相对路径。
如果源路径为文件夹，复制的时候不是直接复制该文件夹，而是将文件夹中的内容复制到目标路径。</p> <blockquote><p>目标路径</p></blockquote> <p>可以是系统的绝对路径 也可以相对于工作路径。目标路径不需要事先创建，如果目录不存在会在复制文件前先行创建缺失目录。</p> <h3 id="cmd"><a href="#cmd" class="header-anchor">#</a> CMD</h3> <p>容器运行起来之后，执行的命令，比如运行什么什么服务，可以支持变量，因为这个本质是sh xxx 会解析环境变量。
如果我们在docker run 最后写了一些指令，那么这些指令就会直接代替cmd的内容。</p> <h3 id="env"><a href="#env" class="header-anchor">#</a> ENV</h3> <p>可以给其他的docker命令支持统一的环境变量，建议把一些需要修改的变量，或者统一的东西作为常量放在ENV里面，这些参数会被加到容器的环境变量中
格式为k1=v1 k2=v2</p> <h3 id="avg"><a href="#avg" class="header-anchor">#</a> AVG</h3> <p>参数，不会加入运行的环境变量中，支持默认值</p> <hr> <h3 id="例子"><a href="#例子" class="header-anchor">#</a> 例子</h3> <blockquote><p>Spring Boot的DockerFile</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>FROM openjdk:17-jdk-alpine
MAINTAINER baeldung.com
COPY target/xxxx-1.0.0.jar app.jar
ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/lan-dian/edit/master/docs/02.技术学习/01.docker/01.入门.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=%E7%AC%94%E8%AE%B0" title="标签">#笔记</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/04/24, 11:31:27</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/4d9eaa/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">docker-原理</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/4d9eaa/">docker-原理</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/830163/"><div>
            设计模式
            <!----></div></a> <span class="date">04-22</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/0c8b87/"><div>
            提示词工程
            <!----></div></a> <span class="date">04-14</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/67ef0c/"><div>
            hbase-原理
            <!----></div></a> <span class="date">04-10</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/lan-dian" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.08014c82.js" defer></script><script src="/assets/js/2.74fbac12.js" defer></script><script src="/assets/js/10.04dc144d.js" defer></script>
  </body>
</html>
